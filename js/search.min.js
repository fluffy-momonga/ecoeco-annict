var searchContent=new function(){var t=new(Object.setPrototypeOf($.extend(function(t){JsonCache.call(this,t)}.prototype,{getDefault:function(){return{data:{searchWorks:{nodes:[],pageInfo:{hasPreviousPage:!1,hasNextPage:!1}}},title:"",version:version}}}),JsonCache.prototype).constructor)("searchWorks"),e=function(){var e=t.get();$("#title").val(e.title);var a=$("#works-template .works").clone(!1,!1);a.empty(),$("#result-works").empty().append(a),e.data.searchWorks.nodes.forEach(function(t){var e=$("#works-template .work-heading").clone(!0,!0);e.removeData().attr("data-id",t.id).attr("data-annict-id",t.annictId);var n="https://annict.jp/works/"+t.annictId;e.find(".work-link").attr("href",n).text(t.title),e.find(".work-status").val(t.viewerStatusState),a.append(e)}),$("#pager-prev").toggle(e.data.searchWorks.pageInfo.hasPreviousPage),$("#pager-next").toggle(e.data.searchWorks.pageInfo.hasNextPage)},a=function(a,n){var r=$("#title").val().trim();api.searchWorks(function(a){a.title=r,t.set(a),t.save(),e(),0==a.data.searchWorks.nodes.length&&alertMessage("作品が見つかりませんでした。","warning")},r,a,n)},n=function(){t.remove(),e()};this.build=function(){$("#searchForm").submit(function(){return a(null,null),!1}),$("#search").click(function(){$(this).blur(),$("#searchForm").submit()}),$("#remove").click(function(){$(this).blur(),n()}),$("#works-template .work-status").change(function(){var t=$(this),e=t.val(),a=t.closest(".work-heading").data("id");api.updateStatus(function(t){var a=t.data.updateStatus.work;"WATCHING"==e?watchingContent.addWork(a):watchingContent.removeWork(a.annictId),alertMessage("変更しました。","info")},a,e)}),$("#pager-prev a").click(function(){$(this).blur(),$(window).scrollTop(0),a(t.get().data.searchWorks.pageInfo.startCursor,null)}),$("#pager-next a").click(function(){$(this).blur(),$(window).scrollTop(0),a(null,t.get().data.searchWorks.pageInfo.endCursor)}),e()},this.clear=n};$(function(){searchContent.build()});