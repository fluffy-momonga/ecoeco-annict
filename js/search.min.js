var searchContent=new function(){var t=new(Object.setPrototypeOf($.extend(function(t){JsonCache.call(this,t)}.prototype,{getDefault:function(){return{data:{searchWorks:{nodes:[],pageInfo:{hasPreviousPage:!1,hasNextPage:!1}}},title:"",version:version}}}),JsonCache.prototype).constructor)("searchWorks"),a=function(){var a=t.get();$("#title").val(a.title);var e=$("#works-template .works").clone(!1,!1);e.empty(),$("#result-works").empty().append(e),a.data.searchWorks.nodes.forEach(function(t){var a=$("#works-template .work-heading").clone(!0,!0);a.removeData().attr("data-id",t.id).attr("data-annict-id",t.annictId);var n="https://annict.jp/works/"+t.annictId;a.find(".work-link").attr("href",n).text(t.title),a.find(".work-status").val(t.viewerStatusState),e.append(a)}),$("#pager-prev").toggle(a.data.searchWorks.pageInfo.hasPreviousPage),$("#pager-next").toggle(a.data.searchWorks.pageInfo.hasNextPage)},e=function(e,n){var r=$("#title").val().trim();api.searchWorks(function(e){e.title=r,t.set(e),t.save(),a(),0==e.data.searchWorks.nodes.length&&alertMessage("対象の作品が見つかりませんでした。","warning")},r,e,n)},n=function(){t.remove(),a()};this.initialize=function(){$("#searchForm").submit(function(){return e(null,null),!1}),$("#search").click(function(){$(this).blur(),$("#searchForm").submit()}),$("#remove").click(function(){$(this).blur(),n()}),$("#works-template .work-status").change(function(){var t=$(this),a=t.val(),e=t.closest(".work-heading").data("id");api.updateStatus(function(t){var e=t.data.updateStatus.work;"WATCHING"==a?watchingContent.addWatchingWorksJson(e):watchingContent.removeWatchingWorksJson(e.annictId),alertMessage("変更完了","info")},e,a)}),$("#pager-prev a").click(function(){$(this).blur(),$(window).scrollTop(0),e(t.get().data.searchWorks.pageInfo.startCursor,null)}),$("#pager-next a").click(function(){$(this).blur(),$(window).scrollTop(0),e(null,t.get().data.searchWorks.pageInfo.endCursor)}),a()},this.clear=n};$(function(){searchContent.initialize()});