function renderSearchWorks(){$("#title").val(searchWorksJson.title);var r=$("#works-template .works").clone(!1,!1);r.empty(),$("#result-works").empty().append(r),searchWorksJson.data.searchWorks.nodes.forEach(function(a){var e=$("#works-template .work-heading").clone(!0,!0);e.removeData().attr("data-id",a.id).attr("data-annict-id",a.annictId);var s="https://annict.jp/works/"+a.annictId;e.find(".work-link").attr("href",s).text(a.title),e.find(".work-status").val(a.viewerStatusState),r.append(e)}),$("#pager-prev").toggle(searchWorksJson.data.searchWorks.pageInfo.hasPreviousPage),$("#pager-next").toggle(searchWorksJson.data.searchWorks.pageInfo.hasNextPage)}function searchWorks(r,a){var e=$("#title").val();api.searchWorks(function(r){searchWorksJson=r,searchWorksJson.title=e,saveSearchWorksJson(),renderSearchWorks(),0==r.data.searchWorks.nodes.length&&alertMessage("対象の作品が見つかりませんでした。","warning")},e,r,a)}loadSearchWorksJson(),$(function(){$("#searchForm").submit(function(){return searchWorks(null,null),!1}),$("#search").click(function(){$(this).blur(),$("#searchForm").submit()}),$("#remove").click(function(){$(this).blur(),clearSearchWorksJson(),renderSearchWorks()}),$("#works-template .work-status").change(function(){var r=$(this),a=r.val(),e=r.closest(".work-heading").data("id");api.updateStatus(function(r){var e=r.data.updateStatus.work;("WATCHING"==a?addWatchingWorksJson(e):removeWatchingWorksJson(e.annictId))&&renderWatchingWorks(),alertMessage("変更完了","info")},e,a)}),$("#pager-prev a").click(function(){$(this).blur(),searchWorks(searchWorksJson.data.searchWorks.pageInfo.startCursor,null)}),$("#pager-next a").click(function(){$(this).blur(),searchWorks(null,searchWorksJson.data.searchWorks.pageInfo.endCursor)}),renderSearchWorks()});